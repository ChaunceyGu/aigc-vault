# æ„å»ºå’Œæ¨é€é•œåƒåˆ° Docker Hub

æœ¬æŒ‡å—è¯´æ˜å¦‚ä½•æ„å»ºåº”ç”¨é•œåƒå¹¶æ¨é€åˆ° Docker Hubï¼Œæ–¹ä¾¿åœ¨ç»¿è” NAS ä¸Šç›´æ¥æ‹‰å–ä½¿ç”¨ã€‚

---

## ğŸ“‹ å‰ç½®å‡†å¤‡

1. **æ³¨å†Œ Docker Hub è´¦å·**ï¼šè®¿é—® https://hub.docker.com æ³¨å†Œè´¦å·
2. **ç™»å½• Docker Hub**ï¼š
   ```bash
   docker login
   ```
   è¾“å…¥ä½ çš„ç”¨æˆ·åå’Œå¯†ç 

3. **ä¿®æ”¹é•œåƒåç§°**ï¼š
   - å°† `YOUR_DOCKERHUB_USERNAME` æ›¿æ¢ä¸ºä½ çš„ Docker Hub ç”¨æˆ·å
   - ä¾‹å¦‚ï¼šå¦‚æœä½ çš„ç”¨æˆ·åæ˜¯ `zhangsan`ï¼Œåˆ™é•œåƒåä¸º `zhangsan/aigc-vault-backend:latest`

---

## ğŸ”¨ æ„å»ºå’Œæ¨é€æ­¥éª¤

### æ­¥éª¤ 1: æ„å»ºåç«¯é•œåƒ

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
docker build -f Dockerfile.backend -t YOUR_DOCKERHUB_USERNAME/aigc-vault-backend:latest .

# æŸ¥çœ‹æ„å»ºçš„é•œåƒ
docker images | grep aigc-vault-backend
```

### æ­¥éª¤ 2: æ¨é€åç«¯é•œåƒ

```bash
docker push YOUR_DOCKERHUB_USERNAME/aigc-vault-backend:latest
```

### æ­¥éª¤ 3: æ„å»ºå‰ç«¯é•œåƒ

```bash
docker build -f Dockerfile.frontend -t YOUR_DOCKERHUB_USERNAME/aigc-vault-frontend:latest .

# æŸ¥çœ‹æ„å»ºçš„é•œåƒ
docker images | grep aigc-vault-frontend
```

### æ­¥éª¤ 4: æ¨é€å‰ç«¯é•œåƒ

```bash
docker push YOUR_DOCKERHUB_USERNAME/aigc-vault-frontend:latest
```

---

## ğŸš€ ä¸€é”®æ„å»ºå’Œæ¨é€è„šæœ¬

åˆ›å»ºä»¥ä¸‹è„šæœ¬å¯ä»¥ä¸€é”®å®Œæˆæ‰€æœ‰æ“ä½œï¼š

### Windows (build-and-push.bat)

```bat
@echo off
set DOCKER_USERNAME=YOUR_DOCKERHUB_USERNAME

echo æ­£åœ¨æ„å»ºåç«¯é•œåƒ...
docker build -f Dockerfile.backend -t %DOCKER_USERNAME%/aigc-vault-backend:latest .

echo æ­£åœ¨æ¨é€åç«¯é•œåƒ...
docker push %DOCKER_USERNAME%/aigc-vault-backend:latest

echo æ­£åœ¨æ„å»ºå‰ç«¯é•œåƒ...
docker build -f Dockerfile.frontend -t %DOCKER_USERNAME%/aigc-vault-frontend:latest .

echo æ­£åœ¨æ¨é€å‰ç«¯é•œåƒ...
docker push %DOCKER_USERNAME%/aigc-vault-frontend:latest

echo å®Œæˆï¼
```

### Linux/Mac (build-and-push.sh)

```bash
#!/bin/bash
DOCKER_USERNAME=YOUR_DOCKERHUB_USERNAME

echo "æ­£åœ¨æ„å»ºåç«¯é•œåƒ..."
docker build -f Dockerfile.backend -t ${DOCKER_USERNAME}/aigc-vault-backend:latest .

echo "æ­£åœ¨æ¨é€åç«¯é•œåƒ..."
docker push ${DOCKER_USERNAME}/aigc-vault-backend:latest

echo "æ­£åœ¨æ„å»ºå‰ç«¯é•œåƒ..."
docker build -f Dockerfile.frontend -t ${DOCKER_USERNAME}/aigc-vault-frontend:latest .

echo "æ­£åœ¨æ¨é€å‰ç«¯é•œåƒ..."
docker push ${DOCKER_USERNAME}/aigc-vault-frontend:latest

echo "å®Œæˆï¼"
```

ä½¿ç”¨æ–¹æ³•ï¼š
```bash
# Windows
build-and-push.bat

# Linux/Mac
chmod +x build-and-push.sh
./build-and-push.sh
```

---

## ğŸ“ ä¿®æ”¹ docker-compose.yml

æ¨é€å®Œæˆåï¼Œä¿®æ”¹ `docker-compose.yml` æ–‡ä»¶ï¼š

```yaml
services:
  backend:
    image: YOUR_DOCKERHUB_USERNAME/aigc-vault-backend:latest  # ä¿®æ”¹è¿™é‡Œ
    # ... å…¶ä»–é…ç½®

  frontend:
    image: YOUR_DOCKERHUB_USERNAME/aigc-vault-frontend:latest  # ä¿®æ”¹è¿™é‡Œ
    # ... å…¶ä»–é…ç½®
```

---

## ğŸŒ åœ¨ç»¿è” NAS ä¸Šä½¿ç”¨

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ Docker Composeï¼ˆæ¨èï¼‰

1. **å‡†å¤‡æ–‡ä»¶**ï¼š
   - åˆ›å»ºç›®å½•ï¼Œä¸Šä¼ ä¿®æ”¹åçš„ `docker-compose.yml`
   - ä¸Šä¼  `migrations/init.sql`ï¼ˆå¦‚æœéœ€è¦åˆå§‹åŒ–æ•°æ®åº“ï¼‰

2. **åœ¨ç»¿è” Docker ç•Œé¢**ï¼š
   - æ‰“å¼€ Docker åº”ç”¨
   - ç‚¹å‡» "å®¹å™¨" â†’ "Compose"
   - åˆ›å»ºæ–°çš„ Stack
   - ç²˜è´´ `docker-compose.yml` å†…å®¹
   - **ä¿®æ”¹é•œåƒåç§°**ä¸ºä½ çš„ Docker Hub é•œåƒ
   - **ä¿®æ”¹ç¯å¢ƒå˜é‡**ï¼ˆæ•°æ®åº“ã€RustFS ç­‰é…ç½®ï¼‰
   - ç‚¹å‡» "å¯åŠ¨"

3. **Docker ä¼šè‡ªåŠ¨æ‹‰å–é•œåƒ**ï¼š
   - é¦–æ¬¡å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨ä» Docker Hub æ‹‰å–é•œåƒ
   - ä¹‹åä½¿ç”¨ `docker-compose pull` å¯ä»¥æ›´æ–°é•œåƒ

### æ–¹æ³•äºŒï¼šä½¿ç”¨ SSH å‘½ä»¤è¡Œ

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /volume1/docker/aigc-vault

# 2. æ‹‰å–æœ€æ–°é•œåƒ
docker-compose pull

# 3. å¯åŠ¨æœåŠ¡
docker-compose up -d

# 4. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

---

## ğŸ”„ æ›´æ–°é•œåƒ

### æ›´æ–°ä»£ç åé‡æ–°æ¨é€

1. **ä¿®æ”¹ä»£ç **
2. **é‡æ–°æ„å»ºå’Œæ¨é€**ï¼š
   ```bash
   # ä½¿ç”¨è„šæœ¬æˆ–æ‰‹åŠ¨æ‰§è¡Œ
   docker build -f Dockerfile.backend -t YOUR_DOCKERHUB_USERNAME/aigc-vault-backend:latest .
   docker push YOUR_DOCKERHUB_USERNAME/aigc-vault-backend:latest
   
   docker build -f Dockerfile.frontend -t YOUR_DOCKERHUB_USERNAME/aigc-vault-frontend:latest .
   docker push YOUR_DOCKERHUB_USERNAME/aigc-vault-frontend:latest
   ```

3. **åœ¨ NAS ä¸Šæ›´æ–°**ï¼š
   ```bash
   docker-compose pull
   docker-compose up -d
   ```

---

## ğŸ“Œ ä½¿ç”¨ç‰ˆæœ¬æ ‡ç­¾ï¼ˆæ¨èï¼‰

ä¸ºäº†æ›´å¥½çš„ç‰ˆæœ¬ç®¡ç†ï¼Œå»ºè®®ä½¿ç”¨ç‰ˆæœ¬æ ‡ç­¾è€Œä¸æ˜¯ `latest`ï¼š

### æ„å»ºæ—¶æŒ‡å®šç‰ˆæœ¬

```bash
VERSION=1.0.0
DOCKER_USERNAME=YOUR_DOCKERHUB_USERNAME

# åç«¯
docker build -f Dockerfile.backend -t ${DOCKER_USERNAME}/aigc-vault-backend:${VERSION} .
docker build -f Dockerfile.backend -t ${DOCKER_USERNAME}/aigc-vault-backend:latest .
docker push ${DOCKER_USERNAME}/aigc-vault-backend:${VERSION}
docker push ${DOCKER_USERNAME}/aigc-vault-backend:latest

# å‰ç«¯
docker build -f Dockerfile.frontend -t ${DOCKER_USERNAME}/aigc-vault-frontend:${VERSION} .
docker build -f Dockerfile.frontend -t ${DOCKER_USERNAME}/aigc-vault-frontend:latest .
docker push ${DOCKER_USERNAME}/aigc-vault-frontend:${VERSION}
docker push ${DOCKER_USERNAME}/aigc-vault-frontend:latest
```

### docker-compose.yml ä¸­ä½¿ç”¨ç‰ˆæœ¬

```yaml
services:
  backend:
    image: YOUR_DOCKERHUB_USERNAME/aigc-vault-backend:1.0.0
    # æˆ–ä½¿ç”¨ latest
    # image: YOUR_DOCKERHUB_USERNAME/aigc-vault-backend:latest
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **é•œåƒå¤§å°**ï¼š
   - åç«¯é•œåƒçº¦ 500MB - 1GB
   - å‰ç«¯é•œåƒçº¦ 50MB - 100MBï¼ˆå·²ä¼˜åŒ–ï¼‰

2. **æ„å»ºæ—¶é—´**ï¼š
   - é¦–æ¬¡æ„å»ºå¯èƒ½éœ€è¦ 5-10 åˆ†é’Ÿ
   - åç»­æ„å»ºå¦‚æœæœ‰ç¼“å­˜ä¼šå¿«å¾ˆå¤š

3. **ç½‘ç»œè¦æ±‚**ï¼š
   - æ¨é€é•œåƒéœ€è¦ç¨³å®šçš„ç½‘ç»œè¿æ¥
   - é•œåƒè¾ƒå¤§ï¼Œä¸Šä¼ å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´

4. **Docker Hub é™åˆ¶**ï¼š
   - å…è´¹è´¦å·æœ‰æ¨é€é¢‘ç‡é™åˆ¶
   - é•œåƒæ€»å¤§å°æ²¡æœ‰ç¡¬æ€§é™åˆ¶ï¼Œä½†å»ºè®®ä¿æŒé•œåƒç²¾ç®€

5. **å®‰å…¨æ€§**ï¼š
   - ä¸è¦åœ¨é•œåƒä¸­åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç ã€å¯†é’¥ç­‰ï¼‰
   - ä½¿ç”¨ç¯å¢ƒå˜é‡ä¼ é€’é…ç½®

---

## ğŸ” éªŒè¯é•œåƒ

### æœ¬åœ°æµ‹è¯•

```bash
# æµ‹è¯•åç«¯é•œåƒ
docker run -p 8000:8000 \
  -e DATABASE_URL=postgresql://user:pass@host:5432/db \
  -e RUSTFS_ENDPOINT_URL=http://192.168.31.3:9900 \
  YOUR_DOCKERHUB_USERNAME/aigc-vault-backend:latest

# æµ‹è¯•å‰ç«¯é•œåƒï¼ˆéœ€è¦å…ˆå¯åŠ¨åç«¯ï¼‰
docker run -p 80:80 YOUR_DOCKERHUB_USERNAME/aigc-vault-frontend:latest
```

### æ£€æŸ¥é•œåƒ

```bash
# æŸ¥çœ‹é•œåƒä¿¡æ¯
docker inspect YOUR_DOCKERHUB_USERNAME/aigc-vault-backend:latest

# æŸ¥çœ‹é•œåƒå¤§å°
docker images YOUR_DOCKERHUB_USERNAME/aigc-vault-backend:latest
```

---

## ğŸ“ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: æ¨é€å¤±è´¥ "unauthorized"

**è§£å†³**ï¼š
```bash
docker logout
docker login
```

### é—®é¢˜ 2: æ¨é€å¤±è´¥ "denied"

**åŸå› **ï¼šé•œåƒåç§°æ ¼å¼ä¸æ­£ç¡®æˆ–æ²¡æœ‰æƒé™

**è§£å†³**ï¼šç¡®ä¿é•œåƒåç§°æ ¼å¼ä¸º `ç”¨æˆ·å/é•œåƒå:æ ‡ç­¾`

### é—®é¢˜ 3: NAS ä¸Šæ‹‰å–é•œåƒå¤±è´¥

**æ£€æŸ¥**ï¼š
1. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
2. Docker Hub æ˜¯å¦å¯ä»¥è®¿é—®
3. é•œåƒåç§°æ˜¯å¦æ­£ç¡®

**æµ‹è¯•**ï¼š
```bash
docker pull YOUR_DOCKERHUB_USERNAME/aigc-vault-backend:latest
```

---

## âœ… å®Œæˆæ¸…å•

- [ ] æ³¨å†Œ Docker Hub è´¦å·
- [ ] ç™»å½• Docker Hub
- [ ] æ„å»ºåç«¯é•œåƒ
- [ ] æ¨é€åç«¯é•œåƒ
- [ ] æ„å»ºå‰ç«¯é•œåƒ
- [ ] æ¨é€å‰ç«¯é•œåƒ
- [ ] ä¿®æ”¹ docker-compose.yml ä¸­çš„é•œåƒåç§°
- [ ] åœ¨ NAS ä¸Šæµ‹è¯•æ‹‰å–é•œåƒ
- [ ] é…ç½®ç¯å¢ƒå˜é‡
- [ ] å¯åŠ¨æœåŠ¡

---

**å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œä½ å°±å¯ä»¥åœ¨ä»»ä½•æ”¯æŒ Docker çš„è®¾å¤‡ä¸Šä½¿ç”¨ä½ çš„é•œåƒäº†ï¼** ğŸ‰

