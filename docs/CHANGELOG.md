# 更新日志

本文档记录所有版本的更新内容。

## v1.3.5 (最新)

**安全增强：**
- ✅ **验证码系统**：登录和注册都添加验证码校验，防止暴力破解
  - 多难度验证码：简单（两位数加减）、中等（乘法/三位数运算）、困难（混合运算/大数运算）
  - 支持加减乘除运算，包括混合运算（如：`15 + 3 × 4 = ?`）
  - 验证码 5 分钟过期，验证后立即标记为已使用
  - 自动清理过期验证码
  - 验证码错误时自动刷新

**优化改进：**
- ✅ 登录和注册表单独立验证码状态，互不干扰
- ✅ 验证码问题显示在标签中，清晰可见
- ✅ 提供刷新按钮，可随时获取新验证码

## v1.3.4

**Bug修复：**
- ✅ 修复 TypeScript 编译错误（重复属性问题）
- ✅ 优化脚本版本读取逻辑，优先使用 Git Tags

## v1.3.3

**Bug修复：**
- ✅ 修复提交信息与标签版本不一致的问题
- ✅ 优化版本发布脚本，确保提交信息和标签使用相同版本号

## v1.3.2

**Bug修复：**
- ✅ 修复脚本版本读取逻辑，优先使用 Git Tags 中的实际发布版本

## v1.3.1

**移动端优化：**
- ✅ **响应式布局优化**：全面优化移动端显示效果
  - 头部导航栏：移动端高度优化（56px），标题简化，按钮尺寸调整
  - 筛选栏：搜索框单独一行，筛选条件两行布局，优化间距
  - 卡片显示：禁用移动端 hover 效果，优化字体和标签大小
  - 分页器：移动端使用简单模式，隐藏复杂选项
  - 详情页：按钮文字简化，内边距优化，文本区域高度调整
- ✅ **触摸交互优化**：
  - 按钮最小高度 36px，增大触摸区域
  - 输入框和选择器最小高度 36px
  - 选择按钮从 28px 增大到 32px
- ✅ **视觉优化**：
  - 移动端字体大小优化（标题、标签、文本）
  - 间距和内边距优化
  - 图片网格间距调整

## v1.3.0

**新功能：**
- ✅ **用户账号系统**：支持用户注册、登录、JWT 认证
- ✅ **个人收藏功能**：用户可以收藏喜欢的记录，支持收藏列表查看
- ✅ **RBAC 权限管理系统**：完整的角色权限控制系统
  - 支持动态创建角色和权限
  - 细粒度权限控制（记录管理、用户管理、角色权限管理等）
  - 权限列表显示中文名称，更易理解
- ✅ **管理员后台**：
  - 用户管理：查看、编辑、删除用户，分配角色
  - 角色权限管理：创建、编辑、删除角色，分配权限
  - 统计信息：用户数量、角色分布等
- ✅ **默认管理员自动创建**：首次部署时自动创建默认管理员账号

**优化改进：**
- ✅ 移除密码保护功能，改用 RBAC 权限控制
- ✅ 优化权限检查逻辑，基于角色和权限进行访问控制
- ✅ 改进用户界面，添加用户菜单和导航

**Bug修复：**
- ✅ 修复用户管理界面空白问题
- ✅ 修复角色显示问题，支持多角色显示
- ✅ 修复权限列表显示，使用中文名称

## v1.2.0

**性能优化：**
- ✅ 后端 API 响应缓存：标签统计、工具列表等使用内存缓存（5分钟）
- ✅ 数据库查询优化：批量查询替代 N+1 查询，提升查询效率 50-70%
- ✅ 前端代码分割：路由懒加载，减少首屏加载时间 20-30%
- ✅ Nginx 配置优化：Gzip 压缩、静态资源缓存、代理缓冲优化
- ✅ 图片上传优化：前端自动压缩（>2MB），减少传输量 50-70%
- ✅ 图片加载优化：多尺寸支持（缩略图/中等尺寸/原图），列表使用中等尺寸
- ✅ 智能缓存策略：中等尺寸图片缓存1年，原图缓存1小时
- ✅ 上传进度显示：实时显示上传进度

**优化改进：**
- ✅ 图片 API 支持 size 参数，可按需获取不同尺寸
- ✅ 列表显示自动使用中等尺寸图片，减少传输量 60-80%
- ✅ 详情页使用原图，保证图片质量
- ✅ Nginx 图片 API 缓存优化，根据尺寸设置不同缓存时间

## v1.1.0

**新功能：**
- ✅ 输出组管理：支持为每条记录创建多个输出组，每个组可独立设置工具、模型和图片
- ✅ 外网访问支持：通过API代理实现文件访问，无需暴露内部RustFS端口
- ✅ 版本信息同步：前后端版本信息同步显示，支持语义化版本
- ✅ GitHub Actions CI/CD：自动构建和推送 Docker 镜像到 Docker Hub
- ✅ 安全扫描：集成 Trivy 进行容器漏洞扫描并上报到 GitHub Security

**优化改进：**
- ✅ 统一图片预览体验：普通图片和NSFW图片使用相同的灯箱样式
- ✅ 搜索防抖优化：减少不必要的API请求
- ✅ 图片加载优化：添加重试机制，提升加载成功率
- ✅ 组件性能优化：使用 React.memo 优化渲染性能
- ✅ 瀑布流随机展示：每次刷新显示不同的随机图片
- ✅ 移动端体验优化：响应式布局，优化手机端交互
- ✅ 图片加载体验：Shimmer 骨架屏、淡入动画、错误处理

**Bug修复：**
- ✅ 修复NSFW图片需要关闭两次的问题
- ✅ 修复编辑页面新增图片不显示的问题
- ✅ 修复筛选栏无法读取工具和模型的问题
- ✅ 修复图片在外网无法访问的问题

## v1.0.0

**基础功能：**
- ✅ 密码保护功能（创建/编辑记录）
- ✅ NSFW 内容管理（自动打码、显示/隐藏切换）
- ✅ 优化的标签输入组件（自动补全、快速添加）
- ✅ 视图切换功能（网格视图/瀑布流视图）
- ✅ 图片下载功能（单张/批量 ZIP）
- ✅ 排序功能（按时间/标题）
- ✅ 批量操作（批量删除/下载）
- ✅ 搜索快捷键支持
- ✅ 性能优化（防抖、缓存、懒加载）
- ✅ 优化的 UI/UX 体验

---

**版本说明**：
- 版本号格式：`v主版本号.次版本号.修订号`
- 主版本号：不兼容的 API 修改
- 次版本号：向下兼容的功能性新增
- 修订号：向下兼容的问题修正

