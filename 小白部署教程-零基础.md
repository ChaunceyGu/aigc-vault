# 🎓 零基础部署教程 - 手把手教你部署

完全不会 Git？没关系！这个教程会一步步教你。

---

## 📚 你需要准备什么？

1. ✅ **GitHub 账号**（如果没有，去 https://github.com 免费注册）
2. ✅ **Docker Hub 账号**（如果没有，去 https://hub.docker.com 免费注册）
3. ✅ **一台可以访问互联网的电脑**（你现在用的这台就行）

---

## 第一步：注册账号（如果还没有）

### 1.1 注册 GitHub

1. 打开浏览器，访问：https://github.com/signup
2. 填写用户名、邮箱、密码
3. 验证邮箱（会收到邮件，点击链接验证）
4. 完成注册 ✅

### 1.2 注册 Docker Hub

1. 打开浏览器，访问：https://hub.docker.com/signup
2. 填写用户名、邮箱、密码
3. 验证邮箱
4. 完成注册 ✅

**记住这两个账号的用户名，后面要用！**

---

## 第二步：安装 Git（如果还没有）

### 2.1 检查是否已安装

1. 按 `Win + R` 键
2. 输入 `cmd`，按回车
3. 在黑色窗口输入：`git --version`
4. 如果显示版本号（如 `git version 2.x.x`），说明已安装 ✅
5. 如果显示 `'git' 不是内部或外部命令`，需要安装

### 2.2 安装 Git

1. 访问：https://git-scm.com/download/win
2. 点击下载（会自动下载 Windows 版本）
3. 双击下载的 `.exe` 文件
4. **一直点"下一步"，使用默认设置即可**
5. 安装完成后，重新打开命令行窗口
6. 再次输入 `git --version` 确认安装成功 ✅

---

## 第三步：把代码传到 GitHub

### 3.1 创建 GitHub 仓库

1. 登录 GitHub（https://github.com）
2. 点击右上角的 **`+` 号** → **New repository**（新建仓库）
3. 填写信息：
   - **Repository name（仓库名）**：输入 `aigc-vault`（或者随便起个名字）
   - **Description（描述）**：可选，输入"AI绘图资源库"
   - **Public/Private**：选 Public（公开）
   - **不要勾选** "Initialize this repository with a README"（不要初始化）
4. 点击绿色的 **Create repository** 按钮

### 3.2 上传代码到 GitHub

**方法一：使用 GitHub Desktop（最简单，推荐）**

1. 下载 GitHub Desktop：
   - 访问：https://desktop.github.com
   - 点击 "Download for Windows"
   - 安装并登录你的 GitHub 账号

2. 在 GitHub Desktop 中：
   - 点击 **File** → **Add Local Repository**
   - 点击 **Choose...**，选择你的项目文件夹（`F:\Project\库存`）
   - 点击 **Add Repository**

3. 首次提交：
   - 左下角会看到很多文件变更
   - 在 **Summary** 输入框写：`Initial commit`
   - 点击 **Commit to main** 按钮

4. 推送到 GitHub：
   - 点击右上角的 **Publish repository** 按钮
   - 勾选 "Keep this code private"（如果想私有）或取消勾选（公开）
   - 点击 **Publish Repository**

**方法二：使用命令行（如果熟悉命令行）**

1. 打开 PowerShell 或 CMD
2. 进入项目目录：
   ```powershell
   cd F:\Project\库存
   ```

3. 初始化 Git（如果还没初始化）：
   ```powershell
   git init
   ```

4. 添加所有文件：
   ```powershell
   git add .
   ```

5. 提交：
   ```powershell
   git commit -m "Initial commit"
   ```

6. 连接到 GitHub 仓库：
   ```powershell
   git remote add origin https://github.com/你的用户名/aigc-vault.git
   ```
   （把"你的用户名"改成你的 GitHub 用户名）

7. 推送代码：
   ```powershell
   git push -u origin main
   ```
   - 会弹出登录窗口，用 GitHub 账号登录

完成！代码已经上传到 GitHub ✅

---

## 第四步：配置自动构建

### 4.1 查看你的代码是否在 GitHub

1. 打开浏览器，访问：`https://github.com/你的用户名/aigc-vault`
2. 应该能看到你的所有代码文件
3. 如果看不到 `.github` 文件夹，继续下一步

### 4.2 上传 GitHub Actions 工作流文件

**如果代码已经在 GitHub：**

1. 在项目文件夹中，确保有 `.github/workflows/build-and-push.yml` 文件
2. 如果没有，检查一下是否在 `.gitignore` 中被忽略了
3. 使用 GitHub Desktop 或命令行提交这个文件：
   ```powershell
   git add .github/workflows/build-and-push.yml
   git commit -m "Add CI/CD"
   git push
   ```

**如果代码还没上传，直接用 GitHub Desktop 上传整个项目（包含 `.github` 文件夹）**

### 4.3 配置 Docker Hub 密钥（重要！）

这是让 GitHub 自动推送到 Docker Hub 的关键步骤。

1. **登录 GitHub**，进入你的仓库页面：`https://github.com/你的用户名/aigc-vault`

2. **点击 Settings**（在仓库页面顶部，有很多标签页，找到"Settings"）

3. **点击左侧菜单的 "Secrets and variables"** → **"Actions"**

4. **点击绿色的 "New repository secret" 按钮**

5. **添加第一个密钥：**
   - **Name（名称）**：输入 `DOCKER_USERNAME`（必须一模一样，大小写敏感）
   - **Secret（密钥）**：输入你的 **Docker Hub 用户名**
   - 点击 **Add secret**

6. **再次点击 "New repository secret"**

7. **添加第二个密钥：**
   - **Name（名称）**：输入 `DOCKER_PASSWORD`（必须一模一样）
   - **Secret（密钥）**：输入你的 **Docker Hub 密码**
   - 点击 **Add secret**

✅ 完成！现在 GitHub 知道了你的 Docker Hub 账号信息。

---

## 第五步：触发自动构建

### 5.1 手动触发（推荐）

1. 进入你的 GitHub 仓库页面
2. 点击顶部的 **"Actions"** 标签（在 "Code"、"Issues" 旁边）
3. 左侧菜单找到 **"Build and Push Docker Images"**
4. 点击这个工作流
5. 点击右上角的 **"Run workflow"** 按钮
6. 选择分支（默认是 `main`）
7. 点击绿色的 **"Run workflow"** 按钮

### 5.2 查看构建进度

1. 在 Actions 页面，你会看到一个新的任务在运行
2. 点击这个任务，可以看到详细的构建日志
3. 等待 5-10 分钟（首次构建会比较慢）
4. 看到绿色的 ✅ 就表示成功了！

### 5.3 确认镜像已推送

1. 登录 Docker Hub：https://hub.docker.com
2. 点击右上角头像 → **Repositories**
3. 应该能看到两个新仓库：
   - `aigc-vault-backend`
   - `aigc-vault-frontend`

✅ 镜像构建完成！

---

## 第六步：在 NAS 上部署

### 6.1 修改 docker-compose.yml

1. 在项目文件夹中找到 `docker-compose.yml` 文件
2. 用记事本或 VS Code 打开
3. 找到这两行：
   ```yaml
   image: YOUR_DOCKERHUB_USERNAME/aigc-vault-backend:latest
   image: YOUR_DOCKERHUB_USERNAME/aigc-vault-frontend:latest
   ```
4. 把 `YOUR_DOCKERHUB_USERNAME` 替换成你的 Docker Hub 用户名
5. 保存文件

### 6.2 配置环境变量

在 `docker-compose.yml` 中找到 `environment:` 部分，修改以下内容：

```yaml
environment:
  # 数据库连接（改成你的数据库地址）
  DATABASE_URL: postgresql://用户名:密码@数据库地址:5432/数据库名
  
  # RustFS/S3 配置（改成你的存储服务地址）
  RUSTFS_ENDPOINT_URL: http://你的存储地址:9000
  RUSTFS_ACCESS_KEY: 你的访问密钥
  RUSTFS_SECRET_KEY: 你的密钥
  
  # 其他配置...
  CORS_ORIGINS: http://localhost,http://nas-ip
```

**如果不确定这些值，参考项目中的 `环境变量配置说明.md` 文件**

### 6.3 上传到 NAS

1. 把整个项目文件夹（或至少 `docker-compose.yml`）上传到 NAS
2. 可以通过：
   - **FTP/SFTP**：用 FileZilla 等工具上传
   - **SMB 共享**：在 NAS 上创建共享文件夹，Windows 直接访问
   - **Web 界面**：如果 NAS 有文件管理界面

### 6.4 在 NAS 上启动

**如果你的 NAS 是绿联 X86：**

1. 通过 SSH 连接到 NAS（或使用 NAS 的终端功能）
2. 进入项目目录
3. 运行：
   ```bash
   docker-compose pull  # 下载镜像
   docker-compose up -d  # 启动服务
   ```

**如果 NAS 有 Docker Compose 图形界面：**
- 在界面上选择 `docker-compose.yml` 文件
- 点击"启动"或"部署"按钮

---

## 以后如何更新？

### 更新代码和镜像

1. **修改代码**（在本地电脑上）

2. **提交并推送：**
   ```powershell
   git add .
   git commit -m "更新说明"
   git push
   ```
   或使用 GitHub Desktop：
   - 写提交说明
   - 点击 Commit
   - 点击 Push origin

3. **GitHub 自动构建**（在 Actions 页面可以看到进度）

4. **在 NAS 上更新：**
   ```bash
   docker-compose pull
   docker-compose up -d
   ```

---

## ❓ 常见问题

### Q1: GitHub 是什么？一定要用吗？

**A:** GitHub 是一个代码托管网站。我们用它来：
- 存储代码
- 自动构建 Docker 镜像

**不用 GitHub 的话**，就需要在本地安装 Docker 自己构建，这就是为什么推荐用 GitHub Actions。

### Q2: Docker Hub 是什么？

**A:** Docker Hub 是 Docker 镜像的"应用商店"。我们构建好的镜像会推送到这里，然后 NAS 可以从这里下载镜像。

### Q3: 我完全不懂 Git，能用其他方法吗？

**A:** 可以！
- **推荐用 GitHub Desktop**（图形界面，比命令行简单）
- 或者直接在 GitHub 网页上上传文件（但不推荐，因为每次都要手动上传）

### Q4: 构建失败了怎么办？

**A:** 
1. 在 GitHub Actions 页面查看失败的任务
2. 点击任务，查看日志
3. 常见原因：
   - Docker Hub 用户名或密码错误 → 检查 Secrets 配置
   - 代码有错误 → 查看日志中的错误信息
   - 网络问题 → 等一会儿再试

### Q5: 我看不懂这些英文，怎么办？

**A:** 
- GitHub 和 Docker Hub 都支持中文界面（在设置里切换语言）
- 如果还是看不懂，可以：
  1. 用浏览器翻译插件（如 Google 翻译）
  2. 截图发给我，我帮你看看

### Q6: 能不能再简单点？

**A:** 如果真的觉得太复杂，可以考虑：
1. **找人帮忙**：让懂技术的朋友帮忙设置一次，以后你只需要 `git push` 就行了
2. **使用 NAS 的 Docker 图形界面**：很多 NAS 有 Docker 管理界面，可能更容易

### Q7: 一定要 NAS 吗？能在电脑上运行吗？

**A:** 可以！如果你的电脑有 Docker：
1. 在电脑上直接运行 `docker-compose up`
2. 访问 `http://localhost:3000` 就能用了

---

## ✅ 完成清单

按照步骤检查：

- [ ] 注册了 GitHub 账号
- [ ] 注册了 Docker Hub 账号
- [ ] 安装了 Git（或 GitHub Desktop）
- [ ] 代码已上传到 GitHub
- [ ] `.github/workflows/build-and-push.yml` 文件已上传
- [ ] 配置了 GitHub Secrets（DOCKER_USERNAME 和 DOCKER_PASSWORD）
- [ ] 触发了构建任务
- [ ] 构建成功（看到绿色 ✅）
- [ ] 在 Docker Hub 看到了镜像
- [ ] 修改了 `docker-compose.yml` 的镜像名称
- [ ] 配置了环境变量
- [ ] 在 NAS 上启动了服务

**全部完成？恭喜你！🎉 可以开始使用了！**

---

## 🆘 需要帮助？

如果遇到问题：
1. 截图错误信息发给我
2. 说明卡在哪一步
3. 我会继续帮你解决！

**记住：第一次设置会比较麻烦，但设置好后，以后更新就很简单了！**

